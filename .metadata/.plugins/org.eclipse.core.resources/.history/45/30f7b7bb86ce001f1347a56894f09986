package com.ecom.util;

import java.io.UnsupportedEncodingException;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;

import jakarta.mail.MessagingException;
import jakarta.mail.internet.MimeMessage;
import jakarta.servlet.http.HttpServletRequest;

public class CommonUtil {

	@Autowired
	private static JavaMailSender mailSender;

	public static Boolean sendMail(String url, String reciepentEmail)
			throws UnsupportedEncodingException, MessagingException {

		MimeMessage message = mailSender.createMimeMessage();
		MimeMessageHelper helper = new MimeMessageHelper(message);

		helper.setFrom("chamidukeshikaz@gmail.com", "Shopping App");
		helper.setTo(reciepentEmail);

		String content = "<p>Hello,</p>" + "<p>You have requested to reset password</p>"
				+ "<p>Click to change password:</p>" + "<p><a href=\"" + url + "\">Change password</a></p>";
		helper.setSubject("Password Reset");
		helper.setText(content,true);
		mailSender.send(message);
		
		return false;
	}

	public static String generateUrl(HttpServletRequest request) {

		// http://localhost:8080/forgot-password
		String siteUrl = request.getRequestURL().toString();

		return siteUrl.replace(request.getServletPath(), "");

	}

}
